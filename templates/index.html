{% extends 'base.html' %}
{% block content %}

<!-- small CSS for hover zoom + card lift -->
<style>
  /* make sure the card image container clips the zoomed image */
  .card-thumb {
    overflow: hidden;
    height: 12rem; /* same as h-48 in Tailwind (48*0.25rem = 12rem) */
    border-top-left-radius: 0.5rem;
    border-top-right-radius: 0.5rem;
  }

  .card-thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 350ms cubic-bezier(.22,.9,.35,1), filter 300ms ease;
    will-change: transform;
    transform-origin: center center;
  }

  /* zoom image slightly on hover */
  .card-hover:hover .card-thumb img {
    transform: scale(1.06);
    filter: brightness(0.98);
  }

  /* lift card a bit and increase shadow on hover */
  .card-hover {
    transition: transform 260ms cubic-bezier(.2,.9,.3,1), box-shadow 260ms ease;
    transform-origin: center center;
  }
  .card-hover:hover {
    transform: translateY(-8px);
    box-shadow: 0 18px 36px rgba(12, 20, 30, 0.18);
  }

  /* make sure links don't show ugly outline on click but keep accessibility focus */
  .card-hover a:focus {
    outline: 3px solid rgba(79, 70, 229, 0.25);
    outline-offset: 4px;
  }
</style>

<section class="mb-6">
  <h1 class="text-3xl font-bold text-black">
    Mystic Tribes of Odisha : Your gateway to local and offbeat adventures.
  </h1>
  <form method="get" class="flex gap-2 mb-4">
    <input name="q" value="{{ q }}" placeholder="Search for districts..." class="border rounded p-2 flex-1">
    <select name="category" class="border rounded p-2">
      <option value="">All Categories</option>
      {% for c in categories %}
        <option value="{{ c }}" {% if c==category %}selected{% endif %}>{{ c|capitalize }}</option>
      {% endfor %}
    </select>
    <button class="bg-indigo-600 text-white px-4 rounded">Search</button>
  </form>
</section>

<section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
  {% for d in results %}
  <article class="bg-white rounded-lg overflow-hidden card-hover">
    <a href="{{ url_for('destination', slug=d.slug) }}" class="block">
      <!-- image container that clips zoom -->
      <div class="card-thumb">
        <img src="{{ url_for('static', filename=(d.gallery[0] if d.gallery else 'images/placeholder.jpg')) }}"
             alt="{{ d.name }}" class="block">
      </div>

      <div class="p-4">
        <h3 class="font-semibold text-xl">{{ d.name }}</h3>
        <p class="text-sm text-gray-600">{{ d.state }} ‚Ä¢ {{ d.category }}</p>
        <p class="mt-2 text-gray-700">
          {{ d.description[:120] }}{% if d.description|length>120 %}...{% endif %}
        </p>
        <div class="mt-3 flex items-center justify-between">
          <div class="text-sm text-gray-600">‚≠ê {{ d.rating }}</div>
          <div class="text-sm text-gray-600">{{ d.best_time or 'Any time' }}</div>
        </div>
      </div>
    </a>
  </article>
  {% endfor %}
</section>

<script>
document.getElementById('spinBtn')?.addEventListener('click', function(){
  this.disabled = true; this.textContent = 'Spinning... üåç';
  setTimeout(()=> { window.location = "{{ url_for('random_dest') }}"; }, 900);
});
</script>
{% endblock %}
